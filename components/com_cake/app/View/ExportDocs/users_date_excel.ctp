<?php $this->PhpExcel->createWorksheet();$this->PhpExcel->setDefaultFont('Calibri', 12);// define table cellsif($isRoot) 	$table = array(			array('label' => __('N'), 'width' => 'auto'),			array('label' => __('Code'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Username'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Name'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Stato'), 'width' => 'auto', 'wrap' => true, 'filter' => true),			array('label' => __('dataRichEnter'), 'filter' => true),			array('label' => __('dataEnter'), 'filter' => true),			array('label' => __('numDeliberaEnter'), 'filter' => true),			array('label' => __('dataDeliberaEnter'), 'filter' => true),			array('label' => __('dataRichExit'), 'filter' => true),			array('label' => __('motivoRichExit'), 'filter' => true),			array('label' => __('dataExit'), 'filter' => true),			array('label' => __('numDeliberaExit'), 'filter' => true),			array('label' => __('dataDeliberaExit'), 'filter' => true),			array('label' => __('dataRestituzCassa'), 'filter' => true),			array('label' => __('notaRestituzCassa'), 'filter' => true),			array('label' => __('nota'), 'filter' => false),			array('label' => __('Mail'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Telephone'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Address'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Suppliers Organizations Referents'), 'width' => 100, 'filter' => false)	);else	$table = array(			array('label' => __('N'), 'width' => 'auto'),			array('label' => __('Code'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Username'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Name'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Stato'), 'width' => 'auto', 'wrap' => true, 'filter' => true),			array('label' => __('dataRichEnter'), 'filter' => true),			array('label' => __('dataEnter'), 'filter' => true),			array('label' => __('numDeliberaEnter'), 'filter' => true),			array('label' => __('dataDeliberaEnter'), 'filter' => true),			array('label' => __('dataRichExit'), 'filter' => true),			array('label' => __('motivoRichExit'), 'filter' => true),			array('label' => __('dataExit'), 'filter' => true),			array('label' => __('numDeliberaExit'), 'filter' => true),			array('label' => __('dataDeliberaExit'), 'filter' => true),			array('label' => __('dataRestituzCassa'), 'filter' => true),			array('label' => __('notaRestituzCassa'), 'filter' => true),			array('label' => __('nota'), 'filter' => false),			array('label' => __('Mail'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Telephone'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Address'), 'width' => 'auto', 'wrap' => true, 'filter' => false),			array('label' => __('Suppliers Organizations Referents'), 'width' => 100, 'filter' => false),	);// heading$this->PhpExcel->addTableHeader($table, array('name' => 'Cambria', 'bold' => true));foreach($results as $numResult => $result) {	$data = array();	if($result['User']['block']==0)		$stato = 'Attivo';	else		$stato = 'Disattivato';		$telephone = "";	if(!empty($result['Profile']['phone'])) $telephone .= $result['Profile']['phone'].' ';	if(!empty($result['Profile']['phone2'])) $telephone .= $result['Profile']['phone2'];		$address = "";	if(!empty($result['Profile']['address'])) $address = $result['Profile']['address'];			$data = array(			($numResult+1),			$result['Profile']['codice'],			$result['User']['username'],			$result['User']['name'],			$stato,	);	/*	 * data Entrata/Uscita	 */	$data[] = $result['Profile']['dataRichEnter'];	$data[] = $result['Profile']['dataEnter'];	$data[] = $result['Profile']['numDeliberaEnter'];	$data[] = $result['Profile']['dataDeliberaEnter'];	$data[] = $result['Profile']['dataRichExit'];	$data[] = $result['Profile']['motivoRichExit'];	$data[] = $result['Profile']['dataExit'];	$data[] = $result['Profile']['numDeliberaExit'];	$data[] = $result['Profile']['dataDeliberaExit'];	$data[] = $result['Profile']['dataRestituzCassa'];	$data[] = $result['Profile']['notaRestituzCassa'];	$data[] = $result['Profile']['nota'];		$data[] = $result['User']['email'];	$data[] = $telephone;	$data[] = $address;	if(isset($result['SuppliersOrganization'])) {		foreach($result['SuppliersOrganization'] as $numSuppliersOrganization => $suppliersOrganization)			$data[] = $suppliersOrganization['name']; /* .' '.$result['SuppliersOrganizationsReferent'][$numSuppliersOrganization]['type']; */	}	else		$data[] = '';		$this->PhpExcel->addTableRow($data);}$this->PhpExcel->addTableFooter();$this->PhpExcel->output($fileData['fileName'].'.xlsx');?>