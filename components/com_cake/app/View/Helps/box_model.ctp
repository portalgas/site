<h1>Model</h1><h2>$belongsTo</h2><pre class="shell" rel="Settare organizaton_id nel Model">public $belongsTo = array(		'Delivery' => array(			'className' => 'Delivery',			'foreignKey' => 'delivery_id',			'conditions' => array('Delivery.organization_id = Order.organization_id'),			'fields' => '',			'order' => ''		),</pre>	<table>	<tr>		<th>Model</th>		<th>Relazione</th>		<th>Conditions</th>		<th>Sql</th>	</tr>	<tr>		<td>Order</td>		<td>Delivery</td>		<td>Delivery.organization_id = Order.organization_id</td>		<td>FROM Orders AS Order<br />			LEFT JOIN k_deliveries AS Delivery ON<br />			(Order.delivery_id = Delivery.id AND<br />			Delivery.organization_id = Order.organization_id)</td>	</tr>	</table><h2>$HasMany</h2> <pre class="shell" rel="Settare organizaton_id nel Controller">public $hasMany = array(	'Order' => array(		'className' => 'Order',		'foreignKey' => 'delivery_id',		'dependent' => false,		'conditions' => '',		...		App::import('Model', 'Delivery');$Model = new Delivery;$Model->hasMany['Order']['conditions'] = array('Order.organization_id' => $this->user->organization['Organization']['id']);</pre>		<table>	<tr>		<th>Model</th>		<th>Relazione</th>		<th>Conditions</th>		<th>Sql</th>	</tr>	<tr>		<td>Delivery</td>		<td>Order</td>		<td>Order.organization_id => $organization_id</td>		<td>FROM k_orders AS Order<br />			WHERE Order.organization_id = 1 AND Order.delivery_id = (1,2,3, all id found)</td>	</tr>		<tr>		<td>Article</td>		<td>ArticlesArticlesType</td>		<td>ArticlesArticlesType.organization_id' => $organization_id</td>		<td>FROM k_articles_articles_types AS ArticlesArticlesType<br />WHERE ArticlesArticlesType.organization_id =1 AND<br />ArticlesArticlesType.article_id = (1,2,3, all id found )</td>	</tr>			<tr>		<td>Article</td>		<td>ArticlesOrder</td>		<td>ArticlesOrder.organization_id' => $organization_id</td>		<td>FROM k_articles_orders AS ArticlesOrder<br />WHERE ArticlesOrder.organization_id =1 AND<br />ArticlesOrder.article_id = (1,2,3, all id found)</td>	</tr>	</table><h2>Article::hasAndBelongsToMany</h2>in Model::Article ho relazione con <ul>	<li>ArticlesOrder -> Article</li>	<li>ArticlesArticleType -> ArticleType</li></ul>ma devo passargli i parametri organization_id nel Controller	<pre class="shell" rel="Article">public $hasAndBelongsToMany = array(	'ArticlesType' => array(			'className' => 'ArticlesType',			'joinTable' => 'articles_articles_types',			'foreignKey' => 'article_id',			'associationForeignKey' => 'article_type_id',	),	'Order' => array(		'className' => 'Order',		'joinTable' => 'articles_orders',		'foreignKey' => 'article_id',		'associationForeignKey' => 'order_id',		'unique' => 'keepExisting',		'conditions' =>  array('Order.organization_id = ArticlesOrder.organization_id'),	));App::import('Model', 'Article');$Model = new Article;$this->Article->hasOne['ArticlesArticlesType']['conditions'] = 'ArticlesArticlesType.organization_id = Article.organization_id AND Article.organization_id = '.$this->user->organization['Organization']['id'];$this->Article->hasMany['ArticlesArticlesType']['conditions'] = array('ArticlesArticlesType.organization_id' => $this->user->organization['Organization']['id']);$this->Article->hasAndBelongsToMany['ArticlesType']['conditions'] = array('ArticlesArticlesType.organization_id' => $this->user->organization['Organization']['id']);$this->Article->hasOne['ArticlesOrder']['conditions'] = 'ArticlesOrder.organization_id = Article.organization_id AND Article.organization_id = '.$this->user->organization['Organization']['id'];$this->Article->hasMany['ArticlesOrder']['conditions'] = array('ArticlesOrder.organization_id' => $this->user->organization['Organization']['id']);$this->Article->hasAndBelongsToMany['Order']['conditions'] = 'Order.organization_id = ArticlesOrder.organization_id AND Order.organization_id = '. $this->user->organization['Organization']['id'];</pre><table>	<tr>		<th>Model</th>		<th>Relazione</th>		<th>Conditions</th>		<th>Sql</th>	</tr>	<tr>		<td>Article</td>		<td>ArticlesType</td>		<td></td>		<td>FROM k_articles_types AS ArticlesType JOIN k_articles_articles_types AS ArticlesArticlesType ON<br />		(ArticlesArticlesType.article_id = 3 AND ArticlesArticlesType.article_type_id = ArticlesType.id)<br />		WHERE ArticlesArticlesType.organization_id = 1</td>	</tr>		<tr>		<td>Article</td>		<td>Order</td>		<td>Order.organization_id = ArticlesOrder.organization_id</td>		<td>FROM k_orders AS Order JOIN k_articles_orders AS ArticlesOrder ON<br /> 			(ArticlesOrder.article_id IN (1,2,3, all id found) AND ArticlesOrder.order_id = Order.id)<br />			WHERE Order.organization_id = ArticlesOrder.organization_id AND Order.organization_id = 1</td>	</tr></table><h2>Order::hasAndBelongsToMany</h2>la relazione con ArticlesOrder -> Article la creo all'occorrenza nel Controller 	<pre class="shell" rel="Article">App::import('Model', 'Order');$Model = new Order;/* * questa prima parte non serve */$Model->hasOne['ArticlesOrder'] = array(	'className' => 'ArticlesOrder',	'foreignKey' => 'order_id',	'dependent' => false,	'conditions' => 'ArticlesOrder.organization_id = Order.organization_id AND Order.organization_id = '.$this->user->organization['Organization']['id']);$Model->hasMany['ArticlesOrder'] = array(	'className' => 'ArticlesOrder',	'foreignKey' => 'order_id',	'dependent' => false,	'conditions' => 'ArticlesOrder.organization_id = '.$this->user->organization['Organization']['id']);/* * questa estrae gli articoli associati all'ordine */$Model->hasAndBelongsToMany['Article'] = array(	'className' => 'Article',	'joinTable' => 'articles_orders',	'foreignKey' => 'order_id',	'associationForeignKey' => 'article_id',	'unique' => 'keepExisting',	'conditions' =>  'Article.organization_id = ArticlesOrder.organization_id AND Article.organization_id = '.$this->user->organization['Organization']['id'],	'with' => 'ArticlesOrder');</pre><table>	<tr>		<th>Model</th>		<th>Relazione</th>		<th>Conditions</th>		<th>Sql</th>	</tr>	<tr>		<td>Order</td>		<td>ArticlesOrder</td>		<td></td>		<td>FROM k_articles AS Article JOIN k_articles_orders AS ArticlesOrder ON<br />			(ArticlesOrder.order_id = 36 AND ArticlesOrder.article_id = Article.id)<br />			WHERE Article.organization_id = ArticlesOrder.organization_id AND<br />			Article.organization_id = 1</td>	</tr>	</table>