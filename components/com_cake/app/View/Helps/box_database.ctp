<h1>Database</h1><h2>MySql</h2>	<ul>		<li>			file di configurazione:			<p>/etc/mysql/my.cnf aggiunto sql_mode = "STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION" per problema ONLY_FULL_GROUP_BY<br />			per gestione temporanea phpmyadmin => Variables => sql mode (elimina ONLY_FULL_GROUP_BY)</p>			<p>/etc/mysql/mysql.conf.d/mysqld.cnf settaggio di mysql</p>		</li>	</ul>		<a name="database_allinea"></a><h2>Migrazione da Produzione e Test</h2>	<ul>		<li><pre class="shell" rel="import/export database">cd /var/www/portalgas/components/com_cake/app/tmp/EXPORT: # mysqldump -u root -p portalgas > dump-portalgas.sqlIMPORT: # mysql -u root -p  test-portalgas < dump-portalgas.sqlIMPORT: # mysql -u root -p  next-portalgas < dump-portalgas.sql</pre>		</li>		<li><pre class="shell" rel="Disabilitare mail/username utente CAVAGNETTA ">UPDATE `test-portalgas`.j_users set email = CONCAT(id, '@gmail.com') where organization_id = 1;UPDATE `test-portalgas`.j_users set username = CONCAT(id, '@gmail.com') where organization_id = 1 and id != 56 and id != 34;-- UPDATE `test-portalgas`.j_users SET email = 'info@gaslacavagnetta.portalgas.it', username = 'info@gaslacavagnetta.portalgas.it', password = '$P$DEHy0kcqfkBZhndO8qyO6H9siOlB8R.' WHERE j_users.id = 56;-- UPDATE `test-portalgas`.j_users SET email = 'malandrel2@gmail.com', username = 'malandrel2@gmail.com' WHERE j_users.id = 34;</pre><pre class="shell" rel="Disabilitare mail/username utente ARCOIRIS ">UPDATE `test-portalgas`.j_users set email = CONCAT(id, '@gmail.com') where organization_id = 3;UPDATE `test-portalgas`.j_users set username = CONCAT(id, '@gmail.com') where organization_id = 3;UPDATE `test-portalgas`.j_users SET email = 'info@arcoiris.portalgas.it', username = 'info@arcoiris.portalgas.it' WHERE j_users.id = 142;</pre><pre class="shell" rel="Disabilitare mail/username utente IVREA (D.E.S.) ">UPDATE `test-portalgas`.j_users set email = CONCAT(id, '@gmail.com') where organization_id = 15;UPDATE `test-portalgas`.j_users set username = CONCAT(id, '@gmail.com') where organization_id = 15;UPDATE `test-portalgas`.j_users SET email = 'info@gasivrea.portalgas.it', username = 'info@gasivrea.portalgas.it' WHERE j_users.id = 826;</pre><pre class="shell" rel="Disabilitare mail/username utente VALCHIUSELLA (D.E.S.) ">UPDATE `test-portalgas`.j_users set email = CONCAT(id, '@gmail.com') where organization_id = 20;UPDATE `test-portalgas`.j_users set username = CONCAT(id, '@gmail.com') where organization_id = 20;UPDATE `test-portalgas`.j_users SET email = 'info@gasvalchiusella.portalgas.it', username = 'info@gasvalchiusella.portalgas.it' WHERE j_users.id = 1335;</pre><pre class="shell" rel="Disabilitare mail/username utente FORIMERCATO ">UPDATE `test-portalgas`.j_users set email = CONCAT(id, '@gmail.com') where organization_id = 41;UPDATE `test-portalgas`.j_users set username = CONCAT(id, '@gmail.com') where organization_id = 41;UPDATE `test-portalgas`.j_users SET email = 'info@forimercato.portalgas.it', username = 'info@forimercato.portalgas.it' WHERE j_users.id = 3585;</pre>		</li>		<li><b>Memo</b>: disabilitare in test il plugin di autenticazione di google se non con le mail cambiate da un msg "un utente locale..."<br />Gestione Plugin: Plugins => filtrare per tipologia => authentication		</li>		<li><pre class="shell" rel="Disabilitare indirizzi">UPDATE `test-portalgas`.j_user_profiles set profile_value = '"Via Roma 1"' where profile_key = 'profile.address';UPDATE `test-portalgas`.j_user_profiles set profile_value = '"333 1234567"' where profile_key = 'profile.phone';UPDATE `test-portalgas`.j_user_profiles set profile_value = '"011 999666"' where profile_key = 'profile.phone2';</pre>		</li>		<li><b>Memo</b>: Folder images		</li>			</ul>	<table>		<tr>			<th>Gas</th>			<th>Tipologia</th>			<th>Account manager</th>			<th>Account</th>			<th>Gruppi</th>			<th>Produttori</th>		</tr>		<tr>			<td>Arcoiris (3)</td>			<td>Pagamento alla consegna</td>			<td>				<ul>					<li>user: info@arcoiris.portalgas.it</li>					<li>pwd: <?php echo Configure::read('pwd');?></li>				</ul>						</td>			<td>				<ul>					<li>user: demo1</li>					<li>pwd: .....</li>					<li>mail: demo1@gmail.com</li>					<li>Profilo utente...</li>				</ul>						</td>			<td>				<ul>					<li>GasPagesArcoiris</li>					<li>manager consegne</li>					<li>referente</li>					<li>cassiere</li>				</ul>						</td>			<td>				<ul>					<li>Agriforneria</li>					<li>Collina delle arance</li>					<li>Coop. Agricola IRIS - Astra bio</li>				</ul>						</td>					</tr>		<tr>			<td>La Cavagnetta (1)</td>			<td>Pagamento dopo la consegna</td>			<td>				<ul>					<li>user: info@gaslacavagnetta.portalgas.it</li>					<li>pwd: <?php echo Configure::read('pwd');?></li>				</ul>						</td>						<td>				<ul>					<li>user: demo2</li>					<li>pwd: .....</li>					<li>mail: demo2@gmail.com</li>					<li>Profilo utente...</li>				</ul>						</td>			<td>				<ul>					<li>GasPagesCavagnetta</li>					<li>manager consegne</li>					<li>referente</li>					<li>cassiere</li>					<li>tesoriere</li>				</ul>						</td>			<td>				<ul>					<li>Agrinova</li>					<li>Collina delle arance</li>					<li>Coop. Agricola IRIS - Astra bio</li>				</ul>						</td>					</tr>		<tr>			<td>Gas Ivrea (15)</td>			<td>Pagamento alla/dopo la consegna</td>			<td>				<ul>					<li>user: info@gasivrea.portalgas.it</li>					<li>pwd: <?php echo Configure::read('pwd');?></li>				</ul>						</td>						<td>				<ul>					<li>user: demodes1</li>					<li>pwd: .....</li>					<li>mail: demodes1@gmail.com</li>					<li>Profilo utente...</li>				</ul>						</td>			<td>				<ul>					<li>GasPagesGasIvrea</li>					<li>manager consegne</li>					<li>referente</li>					<li>cassiere</li>					<li>tesoriere</li>					<li>D.E.S.</li>				</ul>						</td>			<td>			 	<ul>					<li>Aqua</li>					<li>Bio e Mare</li>					<li>Coop. Agricola IRIS - Astra bio</li>					<li>Frutto permesso</li>					<li>... anche per D.E.S.</li>				</ul>						</td>					</tr>		<tr>			<td>Gas Valchiusella (20)</td>			<td>Pagamento alla/dopo la consegna</td>			<td>				<ul>					<li>user: info@gasvalchiusella.portalgas.it</li>					<li>pwd: <?php echo Configure::read('pwd');?></li>				</ul>						</td>						<td>				<ul>					<li>user: demodes2</li>					<li>pwd: .....</li>					<li>mail: demodes2@gmail.com</li>					<li>Profilo utente...</li>				</ul>						</td>			<td>				<ul>					<li>GasPagesGasvalchiusella</li>					<li>manager consegne</li>					<li>referente</li>					<li>cassiere</li>					<li>tesoriere</li>					<li>D.E.S.</li>				</ul>						</td>			<td>			 	<ul>					<li>Coop. Agricola IRIS - Astra bio</li>					<li>Frutto permesso</li>					<li>... anche per D.E.S.</li>					<li>Coop. Agricola IRIS - Astra bio (referente DES)</li>					<li>Frutto permesso (referente DES)</li>				</ul>						</td>					</tr>		<tr>			<td>Forimercato (41)</td>			<td>Pagamento alla consegna</td>			<td>				<ul>					<li>user: info@forimercato.portalgas.it</li>					<li>pwd: <?php echo Configure::read('pwd');?></li>				</ul>						</td>			<td>				<ul>					<li>user: demo3-prep</li>					<li>pwd: .....</li>					<li>mail: demo3-prep@gmail.com</li>					<li>Profilo utente...</li>				</ul>						</td>			<td>				<ul>					<li>GasPagesGasForimercato</li>					<li>manager consegne</li>					<li>super-referente</li>					<li>cassiere</li>					<li>dispensa</li>				</ul>						</td>			<td>				<ul>					<li>*</li>				</ul>						</td>					</tr>	</table>	<h2>Disabilitare users</h2>Se devo <b>disabilitare</b> utenti in Produzione e lasciarli solo in Test<pre class="shell" rel="sql">				update j_users set block = 1 where organization_id = x 	and name != 'Francesco Actis';			</pre>		<h2>Ripristino di un ordine</h2>dal dump eseguire in locale i comandi<pre class="shell" rel="">SELECT *  FROM `k_articles_orders` WHERE `organization_id` = xxx AND `order_id` = xxx;delete FROM `k_articles_orders` WHERE `order_id` != xxx;=> cancella anche k_carts</pre>quindi fare l'export e portarlo in produzione